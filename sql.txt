CREATE MATERIALIZED VIEW IF NOT EXISTS rtd_by_loc_time AS
SELECT id, rtd_time, rtd_loc, rtd_details, rtd_code, regioncode, latitude, longitude
FROM rtd_db
WHERE rtd_loc IS NOT NULL AND rtd_time IS NOT NULL AND id IS NOT NULL
PRIMARY KEY ((rtd_loc), rtd_time, id);



CREATE MATERIALIZED VIEW IF NOT EXISTS rtd_by_region_time AS
SELECT id, rtd_time, regioncode, rtd_loc, rtd_details, rtd_code, latitude, longitude
FROM rtd_db
WHERE regioncode IS NOT NULL AND rtd_time IS NOT NULL AND id IS NOT NULL
PRIMARY KEY ((regioncode), rtd_time, id);

CREATE MATERIALIZED VIEW IF NOT EXISTS rtd_by_code_time AS
SELECT id, rtd_time, rtd_code, rtd_loc, rtd_details, regioncode, latitude, longitude
FROM rtd_db
WHERE rtd_code IS NOT NULL AND rtd_time IS NOT NULL AND id IS NOT NULL
PRIMARY KEY ((rtd_code), rtd_time, id);

pip install beautifulsoup4 requests selenium xmltodict konlpy pandas transformers torch datasets geopy python-dotenv cassandra-driver
